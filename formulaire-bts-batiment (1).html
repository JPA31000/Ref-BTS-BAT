<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√©f√©rentiel BTS B√¢timent - Formulaire interactif</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Instrument+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Instrument Sans', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
const { useState, useMemo } = React;

const connaissancesGlobales = [
  { id: 1, nom: "Projet de construction et cadre r√©glementaire", competences: ["C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "C9", "C10", "C11", "C12", "C13", "C14", "C15"] },
  { id: 2, nom: "Construction durable", competences: ["C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "C9", "C10", "C11", "C12", "C13", "C14", "C15"] },
  { id: 3, nom: "Environnement num√©rique d'un projet", competences: ["C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "C9", "C10", "C11", "C12", "C13", "C14", "C15"] },
  { id: 4, nom: "Sciences de la construction", competences: ["C1", "C2", "C4", "C15"] },
  { id: 5, nom: "Ouvrages et proc√©d√©s de r√©alisation", competences: ["C1", "C2", "C4", "C7", "C9"] },
  { id: 6, nom: "Management et communication", competences: ["C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "C9", "C10", "C11", "C12", "C13", "C14", "C15"] },
  { id: 7, nom: "Sant√© et s√©curit√© au travail", competences: ["C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "C9", "C11", "C12", "C13", "C14", "C15"] },
  { id: 8, nom: "Pr√©paration et organisation de chantier", competences: ["C6", "C7", "C8", "C9", "C10", "C11"] },
  { id: 9, nom: "√âconomie de la construction", competences: ["C3", "C8", "C10", "C11"] },
  { id: 10, nom: "Implantations - Contr√¥les", competences: ["C14"] },
  { id: 11, nom: "D√©marche qualit√©", competences: ["C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "C9", "C11", "C13", "C14", "C15"] }
];

const data = {
  blocs: [
    {
      id: 1,
      nom: "Analyse et proposition de solutions techniques",
      unite: "U5",
      poles: [
        {
          id: "A1.1",
          nom: "Analyse et choix d'une solution technique",
          conditionsExercice: {
            moyens: [
              "Extraits du dossier march√© (CCTP, plans d'architecte, √©tudes de sols, PGC, plan de pr√©vention, plan de circulation‚Ä¶)",
              "Extraits du dossier d'ex√©cution",
              "Donn√©es du site (b√¢timent neuf ou existant)",
              "R√©glementations, normes, certifications en vigueur",
              "Environnement professionnel de l'entreprise (mat√©riel, QSE, RSE, bases de donn√©es)"
            ],
            autonomie: "Partielle"
          },
          resultatsAttendus: {
            "T1.1": [
              "Le besoin du client est analys√© et explicit√©",
              "Les contraintes et les exigences du projet sont identifi√©es",
              "Les besoins et impossibilit√©s techniques sont explicit√©s"
            ],
            "T1.2": [
              "La solution technique est analys√©e",
              "Les points forts et les points de vigilance sont identifi√©s",
              "Les solutions sont compar√©es et un choix est op√©r√©"
            ]
          },
          taches: [
            { id: "T1.1", nom: "Explicitation d'un besoin et formalisation de tout ou partie d'un cahier des charges", competences: ["C1"] },
            { id: "T1.2", nom: "Analyse et choix d'une solution technique", competences: ["C1"] }
          ]
        },
        {
          id: "A1.2",
          nom: "Proposition d'une solution technico-√©conomique",
          conditionsExercice: {
            moyens: [
              "Extraits du dossier march√© (CCTP, plans d'architecte, √©tudes de sols, PGC, plan de pr√©vention‚Ä¶)",
              "Extraits du dossier d'ex√©cution",
              "Donn√©es du site (b√¢timent neuf ou existant)",
              "R√©glementations, normes, certifications en vigueur",
              "Environnement professionnel de l'entreprise (mat√©riel, QSE, RSE, bases de donn√©es)"
            ],
            autonomie: "Partielle"
          },
          resultatsAttendus: {
            "T1.3": [
              "La solution technique est d√©taill√©e (choix des mat√©riaux, m√©thodes, interfaces‚Ä¶) et argument√©e",
              "La solution technique est d√©crite graphiquement",
              "La solution technique respecte les exigences r√©glementaires et du cahier des charges (m√©canique, thermique, acoustique, impact carbone)"
            ],
            "T1.4": [
              "Les charges m√©caniques sont d√©crites et estim√©es",
              "Un mod√®le m√©canique est propos√©",
              "Un calcul de dimensionnement manuel est r√©alis√©",
              "√âl√©ments limit√©s √† : √©lingues, √©tais, semelles de fondation, poutres isostatiques, poutres continues sans calcul hyperstatique, √©l√©ments en porte √† faux, fixations, poteaux"
            ],
            "T1.5": [
              "Des d√©tails constructifs sont √©labor√©s : principes de ferraillage, interfaces, assemblages, composition des parois, croquis d'√©taiement, positionnement des √©lingues",
              "Des coupes ou des vues n√©cessaires √† la d√©finition d'une solution technique sont r√©alis√©es",
              "Des sch√©mas pr√©cisant les principes de r√©alisation en s√©curit√© sont propos√©s"
            ],
            "T1.6": [
              "Un quantitatif est r√©alis√© sur une partie de l'ouvrage",
              "Un prix de vente est propos√© sur une partie de l'ouvrage",
              "La proposition technique et commerciale est r√©alis√©e"
            ]
          },
          taches: [
            { id: "T1.3", nom: "Proposition d'une solution technique", competences: ["C2"] },
            { id: "T1.4", nom: "Dimensionnement manuel des √©l√©ments structurels courants", competences: ["C2"] },
            { id: "T1.5", nom: "R√©alisation de croquis et de sch√©mas", competences: ["C2"] },
            { id: "T1.6", nom: "R√©daction d'une proposition commerciale pour une variante ou des travaux suppl√©mentaires", competences: ["C3"] }
          ]
        }
      ],
      competences: [
        {
          id: "C1",
          nom: "Analyser un cahier des charges, un contexte, des solutions techniques",
          connaissances: [
            { nom: "Technologie de la construction", niveau: 4 },
            { nom: "M√©canique et structure", niveau: 4 },
            { nom: "R√©glementation et normes", niveau: 3 },
            { nom: "Environnement et d√©veloppement durable", niveau: 3 }
          ],
          criteres: [
            "Les donn√©es du projet sont recens√©es et class√©es",
            "Les contraintes du site sont identifi√©es",
            "Le fonctionnement m√©canique est compris et explicit√©",
            "Les exigences r√©glementaires sont identifi√©es",
            "L'analyse comparative des solutions techniques est pertinente et multicrit√®re",
            "Le choix final est justifi√©"
          ],
          taches: ["T1.1", "T1.2"]
        },
        {
          id: "C2",
          nom: "Proposer une solution technique pour le projet, pour une variante ou des travaux suppl√©mentaires",
          connaissances: [
            { nom: "Technologie de la construction", niveau: 4 },
            { nom: "M√©canique et structure", niveau: 4 },
            { nom: "Dessin technique et mod√©lisation", niveau: 3 },
            { nom: "Mat√©riaux", niveau: 3 }
          ],
          criteres: [
            "La solution technique propos√©e est r√©alisable et conforme aux r√®gles de l'art",
            "Le dimensionnement des √©l√©ments de structure courants est correct",
            "Les croquis et sch√©mas sont clairs, pr√©cis et normalis√©s",
            "Les interfaces entre les diff√©rents √©l√©ments d'ouvrage sont trait√©es",
            "La solution prend en compte les aspects de pr√©vention des risques et d'impact environnemental"
          ],
          taches: ["T1.3", "T1.4", "T1.5"]
        },
        {
          id: "C3",
          nom: "Estimer √©conomiquement une √©tude d'avant-projet",
          connaissances: [
            { nom: "√âtude des prix et √©conomie de la construction", niveau: 3 },
            { nom: "M√©tr√©", niveau: 3 }
          ],
          criteres: [
            "Les quantit√©s sont calcul√©es avec pr√©cision (avant-m√©tr√©)",
            "Les prix unitaires sont √©tablis ou recherch√©s dans une base de prix",
            "Le devis estimatif est √©tabli correctement",
            "L'offre commerciale est r√©dig√©e de mani√®re professionnelle"
          ],
          taches: ["T1.6"]
        }
      ]
    },
    {
      id: 2,
      nom: "√âtude et pr√©paration de chantier",
      unite: "U6",
      poles: [
        {
          id: "A2.1",
          nom: "Analyse et √©tude d'un projet",
          conditionsExercice: {
            moyens: [
              "Dossier march√© (CCTP, plans d'architecte, √©tudes de sols, PGC, plan de pr√©vention, plan de circulation)",
              "Dossier d'ex√©cution",
              "Donn√©es du site (b√¢timent neuf ou existant)",
              "Base de donn√©es entreprise (temps unitaires, cadences)",
              "R√©glementations, normes, certifications en vigueur",
              "D√©marche QSE de l'entreprise",
              "D√©marche RSE de l'entreprise si elle existe (d√©marche bas carbone)",
              "Environnement professionnel de l'entreprise (progiciels, mat√©riel, outils num√©riques)"
            ],
            autonomie: "Partielle"
          },
          resultatsAttendus: {
            "T2.1": [
              "Les caract√©ristiques et les contraintes du site sont identifi√©es (acc√®s, r√©seaux, riverains, topographie, g√©otechnique‚Ä¶)",
              "Les intervenants et leurs r√¥les sont identifi√©s",
              "Les pi√®ces √©crites et graphiques sont analys√©es et mises en coh√©rence",
              "Les d√©lais et les phases de travaux sont identifi√©s"
            ],
            "T2.2": [
              "La structure porteuse est identifi√©e",
              "Le cheminement des charges (verticales et horizontales) est identifi√©",
              "Le comportement de la structure est analys√© qualitativement"
            ],
            "T2.3": [
              "Les risques professionnels li√©s √† la coactivit√© et √† l'environnement ext√©rieur sont recens√©s",
              "Les risques professionnels li√©s √† l'ex√©cution des ouvrages sont recens√©s"
            ],
            "T2.4": [
              "Les contraintes environnementales du site sont recens√©es (d√©chets, nuisances sonores, pollutions, biodiversit√©‚Ä¶)",
              "Les exigences environnementales du projet sont identifi√©es (certifications, labels, mat√©riaux biosourc√©s, r√©emploi‚Ä¶)"
            ],
            "T2.5": [
              "Les exigences de qualit√© du projet sont identifi√©es (parements, tol√©rances, √©tanch√©it√© √† l'air‚Ä¶)",
              "Les points singuliers et les interfaces critiques sont rep√©r√©s"
            ]
          },
          taches: [
            { id: "T2.1", nom: "Analyse globale du projet", competences: ["C4"] },
            { id: "T2.2", nom: "Analyse du fonctionnement m√©canique d'un b√¢timent neuf ou existant", competences: ["C4"] },
            { id: "T2.3", nom: "Analyse des risques pour la sant√© et la s√©curit√©", competences: ["C5"] },
            { id: "T2.4", nom: "Analyse des exigences environnementales", competences: ["C5"] },
            { id: "T2.5", nom: "Analyse des exigences de qualit√©", competences: ["C5"] }
          ]
        },
        {
          id: "A2.2",
          nom: "Pr√©paration de chantier",
          conditionsExercice: {
            moyens: [
              "Dossier march√© (CCTP, plans d'architecte, √©tudes de sols, PGC, plan de pr√©vention, plan de circulation)",
              "Dossier d'ex√©cution",
              "Donn√©es du site",
              "Base de donn√©es entreprise (temps unitaires, cadences, co√ªts)",
              "R√©glementations, normes, certifications en vigueur",
              "D√©marche QSE de l'entreprise",
              "D√©marche RSE de l'entreprise si elle existe",
              "Environnement professionnel de l'entreprise (progiciels, mat√©riel, outils num√©riques)"
            ],
            autonomie: "Partielle"
          },
          resultatsAttendus: {
            "T2.6": [
              "Les d√©marches administratives obligatoires sont list√©es (DICT, voirie, installations‚Ä¶)",
              "Les raccordements aux r√©seaux sont anticip√©s",
              "L'√©tat des lieux contradictoire (voirie, avoisinants) est pr√©par√©"
            ],
            "T2.7": [
              "Les modes constructifs sont d√©finis et argument√©s (technique, co√ªt, s√©curit√©, environnement)",
              "La pr√©fabrication ou la r√©alisation in situ est justifi√©e",
              "Le phasage g√©n√©ral des travaux est √©tabli"
            ],
            "T2.8": [
              "Les besoins en main d'≈ìuvre sont √©valu√©s",
              "Les mat√©riels principaux sont choisis et dimensionn√©s (levage, b√©tonnage, √©taiement‚Ä¶)",
              "Les consultations fournisseurs et sous-traitants sont pr√©par√©es"
            ],
            "T2.9": [
              "Les t√¢ches sont ordonnanc√©es et les dur√©es sont calcul√©es",
              "Le chemin critique est identifi√©",
              "Le planning est optimis√© (lissage des ressources)",
              "Les besoins en ressources (mat√©riel, main d'≈ìuvre) sont histogramm√©s"
            ],
            "T2.10": [
              "Les cycles de rotation (banches, planchers) sont d√©finis",
              "La saturation des moyens de levage est v√©rifi√©e"
            ],
            "T2.11": [
              "Les zones de cantonnement, de stockage, de circulation et de travail sont d√©finies et optimis√©es",
              "Les r√©seaux provisoires sont dimensionn√©s et trac√©s",
              "La s√©curit√© du chantier et des tiers est assur√©e (cl√¥tures, signalisation, acc√®s‚Ä¶)",
              "Les contraintes environnementales sont trait√©es (gestion des d√©chets, eaux de lavage‚Ä¶)"
            ],
            "T2.12": [
              "Les modes op√©ratoires d√©taill√©s sont r√©dig√©s et illustr√©s (croquis de phases)",
              "Les mesures de pr√©vention des risques (EPC, EPI) sont int√©gr√©es",
              "Les points d'arr√™t et de contr√¥le qualit√© sont d√©finis",
              "Les dispositions environnementales sont pr√©cis√©es"
            ],
            "T2.13": [
              "Le d√©bours√© sec pr√©visionnel est calcul√© (mat√©riaux, main d'≈ìuvre, mat√©riel)",
              "Les frais de chantier sont estim√©s",
              "La marge pr√©visionnelle est d√©gag√©e"
            ]
          },
          taches: [
            { id: "T2.6", nom: "Recensement des d√©marches pr√©alables √† l'ouverture de chantier", competences: ["C6"] },
            { id: "T2.7", nom: "D√©finition des modes constructifs dans le cadre d'un planning objectif", competences: ["C7"] },
            { id: "T2.8", nom: "Choix et d√©finition des moyens de r√©alisation √† partir du planning objectif", competences: ["C7"] },
            { id: "T2.9", nom: "√âlaboration d'un planning d'ex√©cution d√©taill√©", competences: ["C8"] },
            { id: "T2.10", nom: "√âlaboration de cycles de travaux en coh√©rence avec le planning d'ex√©cution d√©taill√©", competences: ["C9"] },
            { id: "T2.11", nom: "√âlaboration du plan d'installation de chantier", competences: ["C9"] },
            { id: "T2.12", nom: "Conception des modes op√©ratoires sur chantier incluant la d√©marche QSE", competences: ["C9"] },
            { id: "T2.13", nom: "√âlaboration d'un budget travaux", competences: ["C10"] }
          ]
        }
      ],
      competences: [
        {
          id: "C4",
          nom: "Analyser et finaliser la structure en fonction des choix constructifs",
          connaissances: [
            { nom: "M√©canique des structures", niveau: 4 },
            { nom: "Technologie de la construction", niveau: 4 },
            { nom: "Mat√©riaux", niveau: 3 }
          ],
          criteres: [
            "Le comportement de la structure en phase provisoire et d√©finitive est analys√©",
            "Les choix constructifs sont adapt√©s aux contraintes structurelles",
            "La stabilit√© de l'ouvrage en phase de construction est v√©rifi√©e"
          ],
          taches: ["T2.1", "T2.2"]
        },
        {
          id: "C5",
          nom: "Analyser et d√©finir les moyens relatifs aux exigences de qualit√©, de pr√©vention et d'environnement",
          connaissances: [
            { nom: "Qualit√©, S√©curit√©, Environnement (QSE)", niveau: 4 },
            { nom: "R√©glementation du travail", niveau: 3 }
          ],
          criteres: [
            "Les risques sp√©cifiques au chantier sont identifi√©s (PPSPS)",
            "Les moyens de pr√©vention collective et individuelle sont d√©finis",
            "Les exigences environnementales sont traduites en moyens concrets",
            "Le plan de contr√¥le qualit√© est √©bauch√©"
          ],
          taches: ["T2.3", "T2.4", "T2.5"]
        },
        {
          id: "C6",
          nom: "R√©aliser les d√©marches n√©cessaires √† l'ouverture du chantier",
          connaissances: [
            { nom: "Droit de la construction et urbanisme", niveau: 2 },
            { nom: "Gestion administrative de chantier", niveau: 3 }
          ],
          criteres: [
            "La liste des d√©marches est exhaustive et chronologique",
            "Les documents administratifs sont compl√©t√©s correctement",
            "Les d√©lais administratifs sont int√©gr√©s dans la planification"
          ],
          taches: ["T2.6"]
        },
        {
          id: "C7",
          nom: "Choisir et d√©finir les moyens n√©cessaires √† l'organisation du chantier",
          connaissances: [
            { nom: "Mat√©riels de chantier", niveau: 4 },
            { nom: "Organisation de chantier", niveau: 4 }
          ],
          criteres: [
            "Le choix des engins est justifi√©",
            "Le plan d'installation de chantier (PIC) est complet et r√©glementaire",
            "L'installation de chantier optimise les flux et la s√©curit√©"
          ],
          taches: ["T2.7", "T2.8"]
        },
        {
          id: "C8",
          nom: "R√©aliser le planning d'ex√©cution d√©taill√©",
          connaissances: [
            { nom: "Planification et ordonnancement", niveau: 4 },
            { nom: "M√©thodes de construction", niveau: 4 }
          ],
          criteres: [
            "Le d√©coupage en t√¢ches est pertinent",
            "Les dur√©es sont calcul√©es √† partir de temps unitaires fiables",
            "L'encha√Ænement des t√¢ches respecte les contraintes techniques",
            "Le planning respecte le d√©lai global contractuel",
            "Les ressources sont liss√©es"
          ],
          taches: ["T2.9"]
        },
        {
          id: "C9",
          nom: "√âlaborer les processus de r√©alisation d√©taill√©s et les modes op√©ratoires",
          connaissances: [
            { nom: "M√©thodes et proc√©d√©s d'ex√©cution", niveau: 4 },
            { nom: "S√©curit√© et pr√©vention", niveau: 4 }
          ],
          criteres: [
            "Les modes op√©ratoires sont d√©crits chronologiquement",
            "Les croquis de phase sont explicites",
            "La s√©curit√© est int√©gr√©e √† chaque √©tape",
            "Les points de contr√¥le sont identifi√©s"
          ],
          taches: ["T2.10", "T2.11", "T2.12"]
        },
        {
          id: "C10",
          nom: "√âtablir le budget pr√©visionnel de l'op√©ration",
          connaissances: [
            { nom: "Gestion financi√®re de chantier", niveau: 3 }
          ],
          criteres: [
            "Tous les postes de d√©penses sont pris en compte",
            "Les hypoth√®ses de co√ªt sont r√©alistes",
            "Le budget pr√©visionnel est pr√©sent√© clairement"
          ],
          taches: ["T2.13"]
        }
      ]
    },
    {
      id: 3,
      nom: "Suivi et encadrement d'un projet",
      unite: "U7",
      poles: [
        {
          id: "A3.1",
          nom: "Suivi d'un projet",
          conditionsExercice: {
            moyens: [
              "Dossier march√©",
              "Dossier d'ex√©cution (plans, planning, budget)",
              "Documents de suivi (rapports journaliers, bons de livraison‚Ä¶)",
              "R√©unions de chantier",
              "Outils de gestion et de planification"
            ],
            autonomie: "Partielle"
          },
          resultatsAttendus: {
            "T3.1": [
              "L'avancement r√©el est compar√© au planning pr√©visionnel",
              "Les √©carts sont analys√©s et des mesures correctives sont propos√©es",
              "Le planning est recal√©"
            ],
            "T3.2": [
              "Les quantit√©s r√©alis√©es sont relev√©es contradictoirement",
              "Les √©tats d'acomptes sont √©tablis",
              "Les travaux modificatifs sont valoris√©s"
            ],
            "T3.3": [
              "Les fiches de contr√¥le et d'autocontr√¥le sont renseign√©es",
              "Les non-conformit√©s sont trait√©es",
              "Le dossier des ouvrages ex√©cut√©s (DOE) est aliment√© au fil de l'eau"
            ],
            "T3.4": [
              "La r√©union est pr√©par√©e (points √† aborder, documents)",
              "La participation est active et constructive",
              "Un compte-rendu ou un relev√© de d√©cisions est r√©dig√© ou exploit√©"
            ],
            "T3.5": [
              "La conformit√© des ouvrages aux r√®gles de l'art est v√©rifi√©e",
              "Les √©volutions r√©glementaires sont prises en compte"
            ],
            "T3.6": [
              "Les d√©penses r√©elles sont suivies et compar√©es au budget",
              "Les √©carts sont analys√©s",
              "Le reste √† d√©penser est estim√©"
            ]
          },
          taches: [
            { id: "T3.1", nom: "Contr√¥le et suivi de l'avancement du projet", competences: ["C11"] },
            { id: "T3.2", nom: "√âtablissement des situations d'avancement de travaux", competences: ["C11"] },
            { id: "T3.3", nom: "Suivi du processus management qualit√© de l'entreprise", competences: ["C13"] },
            { id: "T3.4", nom: "Participation √† une r√©union", competences: ["C12"] },
            { id: "T3.5", nom: "Application des r√©glementations, des normes et des certifications en vigueur", competences: ["C13"] },
            { id: "T3.6", nom: "Suivi du budget du chantier", competences: ["C11"] }
          ]
        },
        {
          id: "A3.2",
          nom: "Encadrement d'un projet",
          conditionsExercice: {
            moyens: [
              "√âquipe de chantier (compagnons, int√©rimaires, sous-traitants)",
              "PPSPS, Plan de pr√©vention",
              "Mat√©riel et mat√©riaux",
              "Outils de communication"
            ],
            autonomie: "Partielle"
          },
          resultatsAttendus: {
            "T3.7": [
              "Les relations avec la ma√Ætrise d'≈ìuvre, la ma√Ætrise d'ouvrage et les autres corps d'√©tat sont g√©r√©es professionnellement",
              "La coordination avec les sous-traitants est assur√©e"
            ],
            "T3.8": [
              "Les t√¢ches sont r√©parties et les consignes sont donn√©es clairement",
              "Le travail est contr√¥l√© et accompagn√©",
              "L'accueil des nouveaux arrivants est r√©alis√©",
              "La communication interne est favoris√©e"
            ],
            "T3.9": [
              "Les protections collectives et individuelles sont mises en place et maintenues",
              "Les consignes de s√©curit√© sont diffus√©es et expliqu√©es (quarts d'heure s√©curit√©)",
              "Les situations dangereuses sont d√©tect√©es et trait√©es imm√©diatement",
              "Les autorisations de conduite et habilitations sont v√©rifi√©es"
            ],
            "T3.10": [
              "Le tri des d√©chets est effectif et suivi",
              "Les nuisances sont limit√©es",
              "Les proc√©dures en cas de pollution accidentelle sont connues et appliqu√©es"
            ],
            "T3.11": [
              "Les approvisionnements sont planifi√©s et r√©ceptionn√©s",
              "Le stockage est organis√© et g√©r√©",
              "L'entretien et la maintenance du mat√©riel sont suivis",
              "Les flux logistiques sur le chantier sont fluidifi√©s"
            ]
          },
          taches: [
            { id: "T3.7", nom: "Prise en compte des diff√©rents intervenants du projet", competences: ["C12"] },
            { id: "T3.8", nom: "Management d'une √©quipe", competences: ["C12"] },
            { id: "T3.9", nom: "Organisation et mise en ≈ìuvre de la s√©curit√© des personnes et des biens", competences: ["C13"] },
            { id: "T3.10", nom: "Organisation et mise en ≈ìuvre des mesures environnementales sur chantier", competences: ["C13"] },
            { id: "T3.11", nom: "Organisation, logistique et gestion des mat√©riels et des mat√©riaux", competences: ["C12"] }
          ]
        }
      ],
      competences: [
        {
          id: "C11",
          nom: "Assurer le suivi de l'op√©ration",
          connaissances: [
            { nom: "Gestion de projet", niveau: 3 },
            { nom: "Gestion financi√®re", niveau: 3 }
          ],
          criteres: [
            "Les outils de suivi sont tenus √† jour",
            "Les √©carts planning/budget sont d√©tect√©s pr√©cocement",
            "Les situations de travaux sont exactes et justifi√©es"
          ],
          taches: ["T3.1", "T3.2", "T3.6"]
        },
        {
          id: "C12",
          nom: "Participer au management d'une √©quipe",
          connaissances: [
            { nom: "Management d'√©quipe", niveau: 3 },
            { nom: "Communication professionnelle", niveau: 3 }
          ],
          criteres: [
            "La communication avec l'√©quipe est claire et respectueuse",
            "L'organisation du travail de l'√©quipe est efficace",
            "Les conflits √©ventuels sont g√©r√©s ou signal√©s"
          ],
          taches: ["T3.4", "T3.7", "T3.8", "T3.11"]
        },
        {
          id: "C13",
          nom: "Participer √† la mise en ≈ìuvre des mesures de s√©curit√©, environnementales et qualit√©",
          connaissances: [
            { nom: "QSE", niveau: 4 },
            { nom: "R√©glementation", niveau: 3 }
          ],
          criteres: [
            "Les r√®gles de s√©curit√© sont appliqu√©es sur le terrain",
            "Le tri des d√©chets et la propret√© du chantier sont assur√©s",
            "Les contr√¥les qualit√© sont r√©alis√©s et trac√©s"
          ],
          taches: ["T3.3", "T3.5", "T3.9", "T3.10"]
        }
      ]
    },
    {
      id: 4,
      nom: "Contr√¥le qualit√© et r√©ception des ouvrages",
      unite: "U8",
      poles: [
        {
          id: "A4.1",
          nom: "R√©ception et implantation",
          conditionsExercice: {
            moyens: [
              "Plans d'ex√©cution, plans de bornage",
              "Appareils de topographie (niveau, th√©odolite, station totale, GNSS)",
              "Ouvrages existants ou supports"
            ],
            autonomie: "Totale sur des ouvrages courants"
          },
          resultatsAttendus: {
            "T4.1": [
              "La conformit√© des supports (altim√©trie, planim√©trie, √©tat de surface) est v√©rifi√©e",
              "Les r√©servations et interfaces avec les autres corps d'√©tat sont contr√¥l√©es",
              "Un proc√®s-verbal de r√©ception de support est √©tabli si n√©cessaire"
            ],
            "T4.2": [
              "Les rep√®res de r√©f√©rence sont identifi√©s et v√©rifi√©s",
              "L'implantation est r√©alis√©e avec la pr√©cision requise (axes, nus, niveaux)",
              "Les traits de niveau et axes sont mat√©rialis√©s durablement",
              "Un plan de r√©colement de l'implantation peut √™tre √©tabli"
            ]
          },
          taches: [
            { id: "T4.1", nom: "R√©ception des supports et validation des interfaces", competences: ["C14"] },
            { id: "T4.2", nom: "Implantation des ouvrages", competences: ["C14"] }
          ]
        },
        {
          id: "A4.2",
          nom: "Contr√¥le et validation",
          conditionsExercice: {
            moyens: [
              "CCTP, normes, DTU",
              "Fiches techniques produits",
              "Appareils de mesure et de contr√¥le",
              "Ouvrages r√©alis√©s"
            ],
            autonomie: "Partielle"
          },
          resultatsAttendus: {
            "T4.3": [
              "La conformit√© des mat√©riaux livr√©s est v√©rifi√©e (quantit√©, qualit√©, r√©f√©rences)",
              "La mise en ≈ìuvre est contr√¥l√©e en cours d'ex√©cution",
              "Les ouvrages finis sont contr√¥l√©s (aspect, dimensions, fonctionnalit√©s)",
              "Les essais et √©preuves sont organis√©s et suivis (b√©ton, √©tanch√©it√©...)",
              "Les lev√©es de r√©serves sont g√©r√©es"
            ]
          },
          taches: [
            { id: "T4.3", nom: "V√©rification et validation des solutions techniques, des mat√©riaux et des ouvrages r√©alis√©s", competences: ["C15"] }
          ]
        }
      ],
      competences: [
        {
          id: "C14",
          nom: "Implanter et v√©rifier les caract√©ristiques g√©om√©triques des ouvrages",
          connaissances: [
            { nom: "Topographie", niveau: 4 },
            { nom: "G√©om√©trie", niveau: 3 }
          ],
          criteres: [
            "Les appareils topographiques sont utilis√©s correctement",
            "L'implantation est pr√©cise et conforme aux plans",
            "Les relev√©s sont exacts et exploitables"
          ],
          taches: ["T4.1", "T4.2"]
        },
        {
          id: "C15",
          nom: "Contr√¥ler les mat√©riaux, les ouvrages et les solutions techniques",
          connaissances: [
            { nom: "Technologie des mat√©riaux", niveau: 3 },
            { nom: "Proc√©dures de contr√¥le", niveau: 3 }
          ],
          criteres: [
            "Les mat√©riaux sont contr√¥l√©s √† la livraison",
            "Les non-conformit√©s sont identifi√©es et trait√©es",
            "La conformit√© finale de l'ouvrage est v√©rifi√©e par rapport au march√©"
          ],
          taches: ["T4.3"]
        }
      ]
    }
  ]
};

const niveauLabels = {
  1: "Information (Notion)",
  2: "Expression (Compr√©hension)",
  3: "Ma√Ætrise d'outils (Application)",
  4: "Ma√Ætrise m√©thodologique (Analyse)"
};

function FormulaireBTSEBCR() {
  const [selectedBloc, setSelectedBloc] = useState(null);
  const [selectedPole, setSelectedPole] = useState(null);
  const [selectedTache, setSelectedTache] = useState(null);
  const [selectedCompetence, setSelectedCompetence] = useState(null);
  const [viewMode, setViewMode] = useState('competences');
  const [showSeanceModal, setShowSeanceModal] = useState(false);

  const currentBloc = useMemo(() => 
    data.blocs.find(b => b.id === selectedBloc), 
    [selectedBloc]
  );

  const currentPole = useMemo(() => 
    currentBloc?.poles.find(p => p.id === selectedPole), 
    [currentBloc, selectedPole]
  );

  const currentTache = useMemo(() => 
    currentPole?.taches.find(t => t.id === selectedTache), 
    [currentPole, selectedTache]
  );

  const currentCompetence = useMemo(() => 
    currentBloc?.competences.find(c => c.id === selectedCompetence), 
    [currentBloc, selectedCompetence]
  );

  const availableCompetences = useMemo(() => {
    if (!currentBloc) return [];
    
    if (selectedTache && currentTache) {
      return currentBloc.competences.filter(comp => 
        currentTache.competences?.includes(comp.id)
      );
    }
    
    if (selectedPole && currentPole) {
      const competenceIds = new Set();
      currentPole.taches.forEach(tache => {
        tache.competences?.forEach(compId => competenceIds.add(compId));
      });
      return currentBloc.competences.filter(comp => competenceIds.has(comp.id));
    }
    
    return currentBloc.competences;
  }, [currentBloc, currentPole, currentTache, selectedPole, selectedTache]);

  const resetFilters = () => {
    setSelectedBloc(null);
    setSelectedPole(null);
    setSelectedTache(null);
    setSelectedCompetence(null);
  };

  const handleBlocChange = (value) => {
    setSelectedBloc(value ? parseInt(value) : null);
    setSelectedPole(null);
    setSelectedTache(null);
    setSelectedCompetence(null);
  };

  const handlePoleChange = (value) => {
    setSelectedPole(value || null);
    setSelectedTache(null);
    setSelectedCompetence(null);
  };

  const handleTacheChange = (value) => {
    setSelectedTache(value || null);
    setSelectedCompetence(null);
  };

  const handleCompetenceChange = (value) => {
    setSelectedCompetence(value || null);
  };

  const styles = {
    container: {
      minHeight: '100vh',
      background: 'linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%)',
      color: '#e2e8f0',
      fontFamily: "'Instrument Sans', sans-serif",
      padding: '40px 20px'
    },
    wrapper: {
      maxWidth: '1400px',
      margin: '0 auto'
    },
    header: {
      textAlign: 'center',
      marginBottom: '40px',
      position: 'relative',
      padding: '32px'
    },
    glassCard: {
      background: 'rgba(30, 41, 59, 0.7)',
      backdropFilter: 'blur(20px)',
      border: '1px solid rgba(148, 163, 184, 0.1)',
      borderRadius: '24px',
      marginBottom: '24px'
    },
    tag: {
      display: 'inline-flex',
      alignItems: 'center',
      padding: '6px 12px',
      borderRadius: '20px',
      fontSize: '12px',
      fontWeight: 600,
      fontFamily: "'JetBrains Mono', monospace",
      letterSpacing: '0.5px'
    },
    select: {
      width: '100%',
      padding: '14px 16px',
      background: 'rgba(15, 23, 42, 0.8)',
      border: '2px solid rgba(148, 163, 184, 0.2)',
      borderRadius: '12px',
      color: '#e2e8f0',
      fontSize: '14px',
      fontFamily: 'inherit',
      cursor: 'pointer'
    },
    btnMode: {
      padding: '10px 20px',
      border: '2px solid transparent',
      borderRadius: '10px',
      fontSize: '13px',
      fontWeight: 600,
      cursor: 'pointer',
      background: 'rgba(30, 41, 59, 0.6)',
      color: '#94a3b8',
      marginRight: '8px',
      marginBottom: '8px'
    },
    btnModeActive: {
      background: 'linear-gradient(135deg, #fbbf24, #f59e0b)',
      color: '#0f172a',
      borderColor: '#fbbf24'
    },
    btnReset: {
      padding: '12px 24px',
      background: 'transparent',
      border: '2px solid rgba(239, 68, 68, 0.5)',
      borderRadius: '10px',
      color: '#ef4444',
      fontSize: '13px',
      fontWeight: 600,
      cursor: 'pointer'
    },
    btnSeance: {
      width: '100%',
      padding: '16px 24px',
      background: 'linear-gradient(135deg, #10b981, #059669)',
      border: 'none',
      borderRadius: '12px',
      color: '#fff',
      fontSize: '15px',
      fontWeight: 600,
      cursor: 'pointer',
      display: 'flex',
      alignItems: 'center',
      justifyContent: 'center',
      gap: '10px',
      boxShadow: '0 4px 20px rgba(16, 185, 129, 0.3)'
    }
  };

  const getNiveauStyle = (niveau) => {
    const colors = {
      1: { background: 'rgba(34, 197, 94, 0.2)', color: '#4ade80', border: '1px solid rgba(34, 197, 94, 0.3)' },
      2: { background: 'rgba(59, 130, 246, 0.2)', color: '#60a5fa', border: '1px solid rgba(59, 130, 246, 0.3)' },
      3: { background: 'rgba(168, 85, 247, 0.2)', color: '#c084fc', border: '1px solid rgba(168, 85, 247, 0.3)' },
      4: { background: 'rgba(251, 191, 36, 0.2)', color: '#fbbf24', border: '1px solid rgba(251, 191, 36, 0.3)' }
    };
    return { ...styles.tag, ...colors[niveau] };
  };

  return (
    <div style={styles.container}>
      <div style={styles.wrapper}>
        {/* Header */}
        <div style={{...styles.glassCard, ...styles.header}}>
          <div style={{
            position: 'absolute',
            top: 0,
            left: '50%',
            transform: 'translateX(-50%)',
            width: '200px',
            height: '4px',
            background: 'linear-gradient(90deg, transparent, #fbbf24, transparent)',
            borderRadius: '0 0 4px 4px'
          }} />
          <h1 style={{
            fontSize: '2.5rem',
            fontWeight: 700,
            background: 'linear-gradient(135deg, #fbbf24, #f59e0b)',
            WebkitBackgroundClip: 'text',
            WebkitTextFillColor: 'transparent',
            marginBottom: '8px'
          }}>
            R√©f√©rentiel BTS B√¢timent
          </h1>
          <p style={{ color: '#94a3b8', fontSize: '1.1rem' }}>
            Formulaire interactif d'exploration des comp√©tences
          </p>
          <p style={{
            position: 'absolute',
            bottom: '16px',
            right: '24px',
            fontSize: '11px',
            fontStyle: 'italic',
            color: '#64748b'
          }}>
            Jean-Philippe Amat ‚Äî V1.2 ‚Äî 2026
          </p>
        </div>

        {/* Mode Toggle & Reset */}
        <div style={{ 
          display: 'flex', 
          justifyContent: 'space-between', 
          alignItems: 'center',
          marginBottom: '24px',
          flexWrap: 'wrap',
          gap: '16px'
        }}>
          <div style={{ display: 'flex', flexWrap: 'wrap' }}>
            <button 
              style={{...styles.btnMode, ...(viewMode === 'competences' ? styles.btnModeActive : {})}}
              onClick={() => setViewMode('competences')}
            >
              ‚óá Bloc de comp√©tences
            </button>
            <button 
              style={{...styles.btnMode, ...(viewMode === 'tableau' ? styles.btnModeActive : {})}}
              onClick={() => setViewMode('tableau')}
            >
              ‚ñ¶ T√¢ches / Comp√©tences
            </button>
            <button 
              style={{...styles.btnMode, ...(viewMode === 'connaissances' ? styles.btnModeActive : {})}}
              onClick={() => setViewMode('connaissances')}
            >
              ‚ñ§ Connaissances / Comp√©tences
            </button>
          </div>
          
          <button style={styles.btnReset} onClick={resetFilters}>
            ‚Ü∫ R√©initialiser les filtres
          </button>
        </div>

        {/* Filters */}
        <div style={{...styles.glassCard, padding: '32px'}}>
          <h2 style={{ 
            fontSize: '1rem', 
            fontWeight: 600, 
            marginBottom: '24px',
            color: '#fbbf24',
            textTransform: 'uppercase',
            letterSpacing: '2px',
            display: 'flex',
            alignItems: 'center',
            gap: '10px'
          }}>
            <span style={{ 
              width: '8px', 
              height: '8px', 
              background: '#fbbf24', 
              borderRadius: '2px' 
            }} />
            Filtres conditionnels
          </h2>
          
          <div style={{ 
            display: 'grid', 
            gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', 
            gap: '20px' 
          }}>
            {/* Bloc Filter */}
            <div>
              <label style={{ 
                display: 'block', 
                marginBottom: '8px', 
                color: '#94a3b8',
                fontSize: '13px',
                fontWeight: 500
              }}>
                Bloc de comp√©tences
              </label>
              <select style={styles.select} value={selectedBloc || ''} onChange={(e) => handleBlocChange(e.target.value)}>
                <option value="">Tous les blocs</option>
                {data.blocs.map(bloc => (
                  <option key={bloc.id} value={bloc.id}>
                    Bloc {bloc.id} ({bloc.unite}) ‚Äî {bloc.nom}
                  </option>
                ))}
              </select>
            </div>

            {/* Pole Filter */}
            {selectedBloc && (
              <div>
                <label style={{ 
                  display: 'block', 
                  marginBottom: '8px', 
                  color: '#94a3b8',
                  fontSize: '13px',
                  fontWeight: 500
                }}>
                  P√¥le d'activit√©
                </label>
                <select style={styles.select} value={selectedPole || ''} onChange={(e) => handlePoleChange(e.target.value)}>
                  <option value="">Tous les p√¥les</option>
                  {currentBloc?.poles.map(pole => (
                    <option key={pole.id} value={pole.id}>
                      {pole.id} ‚Äî {pole.nom}
                    </option>
                  ))}
                </select>
              </div>
            )}

            {/* Tache Filter */}
            {selectedPole && (
              <div>
                <label style={{ 
                  display: 'block', 
                  marginBottom: '8px', 
                  color: '#94a3b8',
                  fontSize: '13px',
                  fontWeight: 500
                }}>
                  T√¢che professionnelle
                </label>
                <select style={styles.select} value={selectedTache || ''} onChange={(e) => handleTacheChange(e.target.value)}>
                  <option value="">Toutes les t√¢ches</option>
                  {currentPole?.taches.map(tache => (
                    <option key={tache.id} value={tache.id}>
                      {tache.id} ‚Äî {tache.nom}
                    </option>
                  ))}
                </select>
              </div>
            )}

            {/* Competence Filter */}
            {selectedBloc && (
              <div>
                <label style={{ 
                  display: 'block', 
                  marginBottom: '8px', 
                  color: '#94a3b8',
                  fontSize: '13px',
                  fontWeight: 500
                }}>
                  Comp√©tence
                  {selectedTache && (
                    <span style={{ 
                      marginLeft: '8px',
                      fontSize: '11px',
                      color: '#fbbf24',
                      fontStyle: 'italic'
                    }}>
                      (filtr√©e selon {selectedTache})
                    </span>
                  )}
                </label>
                <select style={styles.select} value={selectedCompetence || ''} onChange={(e) => handleCompetenceChange(e.target.value)}>
                  <option value="">{selectedTache ? `Comp√©tences de ${selectedTache}` : 'Toutes les comp√©tences'}</option>
                  {availableCompetences.map(comp => (
                    <option key={comp.id} value={comp.id}>
                      {comp.id} ‚Äî {comp.nom}
                    </option>
                  ))}
                </select>
              </div>
            )}
          </div>

          {/* Bouton Aide √† la cr√©ation de s√©ance */}
          {selectedBloc && (
            <div style={{ marginTop: '24px', paddingTop: '24px', borderTop: '1px solid rgba(148, 163, 184, 0.2)' }}>
              <button
                onClick={() => setShowSeanceModal(true)}
                style={styles.btnSeance}
              >
                <span style={{ fontSize: '20px' }}>üìã</span>
                Aide √† la cr√©ation de s√©ance
              </button>
            </div>
          )}
        </div>

        {/* Modal Aide √† la cr√©ation de s√©ance */}
        {showSeanceModal && (
          <div style={{
            position: 'fixed',
            top: 0,
            left: 0,
            right: 0,
            bottom: 0,
            background: 'rgba(0, 0, 0, 0.8)',
            backdropFilter: 'blur(8px)',
            zIndex: 1000,
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            padding: '20px'
          }} onClick={() => setShowSeanceModal(false)}>
            <div 
              style={{
                ...styles.glassCard,
                maxWidth: '900px',
                maxHeight: '90vh',
                overflow: 'auto',
                padding: '32px',
                position: 'relative'
              }}
              onClick={(e) => e.stopPropagation()}
            >
              {/* Header Modal */}
              <div style={{ 
                display: 'flex', 
                justifyContent: 'space-between', 
                alignItems: 'flex-start',
                marginBottom: '24px'
              }}>
                <div>
                  <h2 style={{ 
                    fontSize: '1.5rem', 
                    fontWeight: 700, 
                    color: '#10b981',
                    marginBottom: '8px'
                  }}>
                    üìã Aide √† la cr√©ation de s√©ance
                  </h2>
                  <p style={{ color: '#94a3b8', fontSize: '14px' }}>
                    R√©capitulatif des √©l√©ments selon vos choix de filtrage
                  </p>
                </div>
                <button
                  onClick={() => setShowSeanceModal(false)}
                  style={{
                    background: 'rgba(239, 68, 68, 0.2)',
                    border: '1px solid rgba(239, 68, 68, 0.3)',
                    borderRadius: '8px',
                    color: '#ef4444',
                    padding: '8px 12px',
                    cursor: 'pointer',
                    fontSize: '14px'
                  }}
                >
                  ‚úï Fermer
                </button>
              </div>

              {/* Contexte s√©lectionn√© */}
              <div style={{
                background: 'rgba(251, 191, 36, 0.1)',
                borderRadius: '12px',
                padding: '16px',
                marginBottom: '24px',
                borderLeft: '4px solid #fbbf24'
              }}>
                <h3 style={{ color: '#fbbf24', fontSize: '14px', fontWeight: 600, marginBottom: '12px', textTransform: 'uppercase', letterSpacing: '1px' }}>
                  Contexte s√©lectionn√©
                </h3>
                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px' }}>
                  {currentBloc && (
                    <span style={getNiveauStyle(4)}>Bloc {currentBloc.id} - {currentBloc.nom}</span>
                  )}
                  {currentPole && (
                    <span style={getNiveauStyle(3)}>{currentPole.id} - {currentPole.nom}</span>
                  )}
                  {currentTache && (
                    <span style={getNiveauStyle(2)}>{currentTache.id}</span>
                  )}
                  {currentCompetence && (
                    <span style={getNiveauStyle(1)}>{currentCompetence.id}</span>
                  )}
                </div>
              </div>

              {/* Conditions d'exercice */}
              {currentPole?.conditionsExercice && (
                <div style={{ marginBottom: '24px' }}>
                  <h3 style={{ 
                    color: '#60a5fa', 
                    fontSize: '14px', 
                    fontWeight: 600, 
                    marginBottom: '16px',
                    textTransform: 'uppercase',
                    letterSpacing: '1px',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '8px'
                  }}>
                    <span>üîß</span> Moyens et ressources
                  </h3>
                  <div style={{
                    background: 'rgba(96, 165, 250, 0.1)',
                    borderRadius: '12px',
                    padding: '16px'
                  }}>
                    <ul style={{ margin: 0, paddingLeft: '20px' }}>
                      {currentPole.conditionsExercice.moyens.map((moyen, idx) => (
                        <li key={idx} style={{ color: '#e2e8f0', marginBottom: '8px', fontSize: '14px' }}>
                          {moyen}
                        </li>
                      ))}
                    </ul>
                    <div style={{ 
                      marginTop: '16px', 
                      paddingTop: '12px', 
                      borderTop: '1px solid rgba(96, 165, 250, 0.2)',
                      display: 'flex',
                      alignItems: 'center',
                      gap: '8px'
                    }}>
                      <span style={{ color: '#94a3b8', fontSize: '13px' }}>Autonomie :</span>
                      <span style={{
                        background: currentPole.conditionsExercice.autonomie === 'Totale sur des ouvrages courants' 
                          ? 'rgba(34, 197, 94, 0.2)' 
                          : 'rgba(251, 191, 36, 0.2)',
                        color: currentPole.conditionsExercice.autonomie === 'Totale sur des ouvrages courants'
                          ? '#4ade80'
                          : '#fbbf24',
                        padding: '4px 10px',
                        borderRadius: '6px',
                        fontSize: '12px',
                        fontWeight: 600
                      }}>
                        {currentPole.conditionsExercice.autonomie}
                      </span>
                    </div>
                  </div>
                </div>
              )}

              {/* R√©sultats attendus */}
              {currentPole?.resultatsAttendus && (
                <div style={{ marginBottom: '24px' }}>
                  <h3 style={{ 
                    color: '#c084fc', 
                    fontSize: '14px', 
                    fontWeight: 600, 
                    marginBottom: '16px',
                    textTransform: 'uppercase',
                    letterSpacing: '1px',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '8px'
                  }}>
                    <span>üéØ</span> R√©sultats attendus
                  </h3>
                  <div style={{
                    background: 'rgba(192, 132, 252, 0.1)',
                    borderRadius: '12px',
                    padding: '16px'
                  }}>
                    {selectedTache && currentPole.resultatsAttendus[selectedTache] ? (
                      <div>
                        <div style={{
                          display: 'flex',
                          alignItems: 'center',
                          gap: '8px',
                          marginBottom: '12px',
                          paddingBottom: '8px',
                          borderBottom: '1px solid rgba(192, 132, 252, 0.2)'
                        }}>
                          <span style={{
                            background: 'rgba(192, 132, 252, 0.3)',
                            color: '#c084fc',
                            padding: '2px 8px',
                            borderRadius: '4px',
                            fontSize: '11px',
                            fontWeight: 600
                          }}>{selectedTache}</span>
                          <span style={{ color: '#94a3b8', fontSize: '12px' }}>
                            {currentTache?.nom}
                          </span>
                        </div>
                        {currentPole.resultatsAttendus[selectedTache].map((resultat, idx) => (
                          <div key={idx} style={{ 
                            display: 'flex', 
                            alignItems: 'flex-start', 
                            gap: '10px',
                            marginBottom: '10px'
                          }}>
                            <span style={{
                              width: '20px',
                              height: '20px',
                              background: 'rgba(192, 132, 252, 0.3)',
                              borderRadius: '50%',
                              display: 'flex',
                              alignItems: 'center',
                              justifyContent: 'center',
                              fontSize: '10px',
                              color: '#c084fc',
                              flexShrink: 0
                            }}>‚úì</span>
                            <span style={{ color: '#e2e8f0', fontSize: '14px' }}>{resultat}</span>
                          </div>
                        ))}
                      </div>
                    ) : (
                      Object.entries(currentPole.resultatsAttendus).map(([tacheId, resultats]) => (
                        <div key={tacheId} style={{ marginBottom: '16px' }}>
                          <div style={{
                            display: 'flex',
                            alignItems: 'center',
                            gap: '8px',
                            marginBottom: '10px',
                            paddingBottom: '6px',
                            borderBottom: '1px solid rgba(192, 132, 252, 0.2)'
                          }}>
                            <span style={{
                              background: 'rgba(192, 132, 252, 0.3)',
                              color: '#c084fc',
                              padding: '2px 8px',
                              borderRadius: '4px',
                              fontSize: '11px',
                              fontWeight: 600
                            }}>{tacheId}</span>
                            <span style={{ color: '#94a3b8', fontSize: '12px' }}>
                              {currentPole.taches.find(t => t.id === tacheId)?.nom}
                            </span>
                          </div>
                          {resultats.map((resultat, idx) => (
                            <div key={idx} style={{ 
                              display: 'flex', 
                              alignItems: 'flex-start', 
                              gap: '10px',
                              marginBottom: '8px',
                              marginLeft: '8px'
                            }}>
                              <span style={{
                                width: '16px',
                                height: '16px',
                                background: 'rgba(192, 132, 252, 0.2)',
                                borderRadius: '50%',
                                display: 'flex',
                                alignItems: 'center',
                                justifyContent: 'center',
                                fontSize: '8px',
                                color: '#c084fc',
                                flexShrink: 0
                              }}>‚úì</span>
                              <span style={{ color: '#e2e8f0', fontSize: '13px' }}>{resultat}</span>
                            </div>
                          ))}
                        </div>
                      ))
                    )}
                  </div>
                </div>
              )}

              {/* Comp√©tences mobilis√©es */}
              {availableCompetences.length > 0 && (
                <div style={{ marginBottom: '24px' }}>
                  <h3 style={{ 
                    color: '#fbbf24', 
                    fontSize: '14px', 
                    fontWeight: 600, 
                    marginBottom: '16px',
                    textTransform: 'uppercase',
                    letterSpacing: '1px',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '8px'
                  }}>
                    <span>‚ö°</span> Comp√©tences mobilis√©es
                  </h3>
                  {availableCompetences.map(comp => (
                    <div key={comp.id} style={{
                      background: 'rgba(251, 191, 36, 0.1)',
                      borderRadius: '12px',
                      padding: '16px',
                      marginBottom: '12px'
                    }}>
                      <div style={{ 
                        display: 'flex', 
                        alignItems: 'center', 
                        gap: '10px',
                        marginBottom: '12px'
                      }}>
                        <span style={{
                          background: 'linear-gradient(135deg, #fbbf24, #f59e0b)',
                          color: '#0f172a',
                          padding: '4px 10px',
                          borderRadius: '6px',
                          fontWeight: 700,
                          fontSize: '12px'
                        }}>{comp.id}</span>
                        <span style={{ color: '#e2e8f0', fontWeight: 500 }}>{comp.nom}</span>
                      </div>

                      <div style={{ marginBottom: '12px' }}>
                        <span style={{ color: '#94a3b8', fontSize: '12px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>
                          Connaissances associ√©es :
                        </span>
                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px', marginTop: '8px' }}>
                          {comp.connaissances.map((conn, idx) => (
                            <span key={idx} style={{
                              background: 'rgba(30, 41, 59, 0.6)',
                              padding: '4px 10px',
                              borderRadius: '6px',
                              fontSize: '12px',
                              color: '#e2e8f0',
                              display: 'flex',
                              alignItems: 'center',
                              gap: '6px'
                            }}>
                              {conn.nom}
                              <span style={getNiveauStyle(conn.niveau)}>
                                N{conn.niveau}
                              </span>
                            </span>
                          ))}
                        </div>
                      </div>

                      <div>
                        <span style={{ color: '#94a3b8', fontSize: '12px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>
                          Crit√®res d'√©valuation :
                        </span>
                        <ul style={{ margin: '8px 0 0 0', paddingLeft: '20px' }}>
                          {comp.criteres.map((critere, idx) => (
                            <li key={idx} style={{ color: '#94a3b8', fontSize: '13px', marginBottom: '4px' }}>
                              {critere}
                            </li>
                          ))}
                        </ul>
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </div>
          </div>
        )}

        {/* Results */}
        <div style={{...styles.glassCard, padding: '32px'}}>
          <h2 style={{ 
            fontSize: '1rem', 
            fontWeight: 600, 
            marginBottom: '24px',
            color: '#fbbf24',
            textTransform: 'uppercase',
            letterSpacing: '2px',
            display: 'flex',
            alignItems: 'center',
            gap: '10px'
          }}>
            <span style={{ 
              width: '8px', 
              height: '8px', 
              background: '#fbbf24', 
              borderRadius: '2px' 
            }} />
            R√©sultats
          </h2>

          {viewMode === 'competences' && (
            <div>
              {!selectedBloc ? (
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '16px' }}>
                  {data.blocs.map(bloc => (
                    <div 
                      key={bloc.id} 
                      onClick={() => handleBlocChange(bloc.id.toString())}
                      style={{ 
                        background: 'rgba(15, 23, 42, 0.6)',
                        border: '1px solid rgba(148, 163, 184, 0.1)',
                        borderRadius: '16px',
                        padding: '20px',
                        cursor: 'pointer',
                        transition: 'all 0.2s ease'
                      }}
                    >
                      <div style={{ 
                        display: 'flex', 
                        alignItems: 'center', 
                        gap: '12px',
                        marginBottom: '12px'
                      }}>
                        <span style={getNiveauStyle(4)}>{bloc.unite}</span>
                        <span style={{ 
                          fontSize: '12px', 
                          color: '#64748b',
                          fontFamily: "'JetBrains Mono', monospace"
                        }}>
                          Bloc {bloc.id}
                        </span>
                      </div>
                      <h3 style={{ fontSize: '1rem', fontWeight: 600, marginBottom: '12px' }}>
                        {bloc.nom}
                      </h3>
                      <div style={{ display: 'flex', gap: '16px', fontSize: '13px', color: '#64748b' }}>
                        <span>{bloc.poles.length} p√¥les</span>
                        <span>{bloc.competences.length} comp√©tences</span>
                      </div>
                    </div>
                  ))}
                </div>
              ) : (
                <div>
                  {(selectedCompetence ? [currentCompetence] : availableCompetences).filter(Boolean).map(comp => (
                    <div key={comp.id} style={{
                      background: 'rgba(15, 23, 42, 0.6)',
                      border: '1px solid rgba(148, 163, 184, 0.1)',
                      borderRadius: '16px',
                      padding: '20px',
                      marginBottom: '16px'
                    }}>
                      <div style={{ 
                        display: 'flex', 
                        alignItems: 'center', 
                        gap: '12px',
                        marginBottom: '16px'
                      }}>
                        <span style={{
                          background: 'linear-gradient(135deg, #fbbf24, #f59e0b)',
                          color: '#0f172a',
                          padding: '6px 12px',
                          borderRadius: '8px',
                          fontWeight: 700,
                          fontSize: '14px',
                          fontFamily: "'JetBrains Mono', monospace"
                        }}>{comp.id}</span>
                        <h3 style={{ fontSize: '1.1rem', fontWeight: 600, margin: 0 }}>
                          {comp.nom}
                        </h3>
                      </div>

                      <div style={{ marginBottom: '16px' }}>
                        <h4 style={{ 
                          fontSize: '13px', 
                          color: '#94a3b8', 
                          marginBottom: '12px',
                          textTransform: 'uppercase',
                          letterSpacing: '1px'
                        }}>
                          Connaissances associ√©es
                        </h4>
                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px' }}>
                          {comp.connaissances.map((conn, idx) => (
                            <span key={idx} style={{
                              background: 'rgba(30, 41, 59, 0.6)',
                              padding: '8px 12px',
                              borderRadius: '8px',
                              fontSize: '13px',
                              color: '#e2e8f0',
                              display: 'flex',
                              alignItems: 'center',
                              gap: '8px'
                            }}>
                              {conn.nom}
                              <span style={getNiveauStyle(conn.niveau)}>
                                N{conn.niveau}
                              </span>
                            </span>
                          ))}
                        </div>
                      </div>

                      <div>
                        <h4 style={{ 
                          fontSize: '13px', 
                          color: '#94a3b8', 
                          marginBottom: '12px',
                          textTransform: 'uppercase',
                          letterSpacing: '1px'
                        }}>
                          Crit√®res d'√©valuation
                        </h4>
                        {comp.criteres.map((critere, idx) => (
                          <div key={idx} style={{
                            display: 'flex',
                            alignItems: 'flex-start',
                            gap: '12px',
                            padding: '12px 16px',
                            background: 'rgba(30, 41, 59, 0.4)',
                            borderRadius: '10px',
                            marginBottom: '8px',
                            borderLeft: '3px solid #fbbf24'
                          }}>
                            <span style={{
                              width: '20px',
                              height: '20px',
                              borderRadius: '50%',
                              background: 'linear-gradient(135deg, #fbbf24, #f59e0b)',
                              display: 'flex',
                              alignItems: 'center',
                              justifyContent: 'center',
                              fontSize: '10px',
                              color: '#0f172a',
                              flexShrink: 0
                            }}>‚úì</span>
                            <span style={{ color: '#e2e8f0', fontSize: '14px' }}>{critere}</span>
                          </div>
                        ))}
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </div>
          )}

          {viewMode === 'tableau' && (
            <div style={{ overflowX: 'auto' }}>
              <p style={{ color: '#94a3b8', marginBottom: '16px', fontSize: '14px' }}>
                Tableau crois√© des t√¢ches professionnelles et des comp√©tences mobilis√©es
              </p>
              <table style={{ 
                width: '100%', 
                borderCollapse: 'collapse',
                fontSize: '12px'
              }}>
                <thead>
                  <tr>
                    <th style={{ 
                      background: 'rgba(30, 41, 59, 0.8)',
                      padding: '12px 8px',
                      textAlign: 'left',
                      borderBottom: '2px solid #fbbf24',
                      position: 'sticky',
                      left: 0,
                      zIndex: 2,
                      minWidth: '300px'
                    }}>
                      T√¢ches professionnelles
                    </th>
                    {data.blocs.flatMap(bloc => 
                      bloc.competences.map(comp => (
                        <th 
                          key={comp.id}
                          style={{ 
                            background: 'rgba(30, 41, 59, 0.6)',
                            padding: '8px 4px',
                            textAlign: 'center',
                            borderBottom: '2px solid #fbbf24',
                            minWidth: '45px'
                          }}
                          title={comp.nom}
                        >
                          <span style={{ 
                            color: '#fbbf24', 
                            fontWeight: 700,
                            fontSize: '11px'
                          }}>
                            {comp.id}
                          </span>
                        </th>
                      ))
                    )}
                  </tr>
                </thead>
                <tbody>
                  {data.blocs.flatMap(bloc => 
                    bloc.poles.flatMap(pole => 
                      pole.taches.map(tache => (
                        <tr key={tache.id}>
                          <td style={{ 
                            background: 'rgba(15, 23, 42, 0.6)',
                            padding: '10px 12px',
                            borderBottom: '1px solid rgba(148, 163, 184, 0.1)',
                            position: 'sticky',
                            left: 0,
                            zIndex: 1
                          }}>
                            <span style={{ 
                              color: '#c084fc',
                              fontFamily: "'JetBrains Mono', monospace",
                              fontSize: '11px',
                              marginRight: '10px',
                              fontWeight: 600
                            }}>
                              {tache.id}
                            </span>
                            <span style={{ color: '#e2e8f0', fontSize: '12px' }}>{tache.nom}</span>
                          </td>
                          {data.blocs.flatMap(b => 
                            b.competences.map(comp => (
                              <td 
                                key={`${tache.id}-${comp.id}`}
                                style={{ 
                                  background: 'rgba(15, 23, 42, 0.4)',
                                  padding: '8px',
                                  textAlign: 'center',
                                  borderBottom: '1px solid rgba(148, 163, 184, 0.1)'
                                }}
                              >
                                {tache.competences?.includes(comp.id) && (
                                  <span style={{ 
                                    display: 'inline-block',
                                    width: '20px',
                                    height: '20px',
                                    borderRadius: '4px',
                                    background: 'linear-gradient(135deg, #fbbf24, #f59e0b)',
                                    color: '#0f172a',
                                    fontWeight: 700,
                                    fontSize: '12px',
                                    lineHeight: '20px'
                                  }}>
                                    ‚úï
                                  </span>
                                )}
                              </td>
                            ))
                          )}
                        </tr>
                      ))
                    )
                  )}
                </tbody>
              </table>
            </div>
          )}

          {viewMode === 'connaissances' && (
            <div style={{ overflowX: 'auto' }}>
              <p style={{ color: '#94a3b8', marginBottom: '16px', fontSize: '14px' }}>
                Tableau crois√© des savoirs associ√©s et des comp√©tences
              </p>
              <table style={{ 
                width: '100%', 
                borderCollapse: 'collapse',
                fontSize: '12px'
              }}>
                <thead>
                  <tr>
                    <th style={{ 
                      background: 'rgba(30, 41, 59, 0.8)',
                      padding: '12px 8px',
                      textAlign: 'left',
                      borderBottom: '2px solid #fbbf24',
                      position: 'sticky',
                      left: 0,
                      zIndex: 2,
                      minWidth: '250px'
                    }}>
                      Connaissances
                    </th>
                    {data.blocs.flatMap(bloc => 
                      bloc.competences.map(comp => (
                        <th 
                          key={comp.id}
                          style={{ 
                            background: 'rgba(30, 41, 59, 0.6)',
                            padding: '8px 4px',
                            textAlign: 'center',
                            borderBottom: '2px solid #fbbf24',
                            minWidth: '45px'
                          }}
                          title={comp.nom}
                        >
                          <span style={{ 
                            color: '#fbbf24', 
                            fontWeight: 700,
                            fontSize: '11px'
                          }}>
                            {comp.id}
                          </span>
                        </th>
                      ))
                    )}
                  </tr>
                </thead>
                <tbody>
                  {connaissancesGlobales.map(conn => (
                    <tr key={conn.id}>
                      <td style={{ 
                        background: 'rgba(15, 23, 42, 0.6)',
                        padding: '10px 12px',
                        borderBottom: '1px solid rgba(148, 163, 184, 0.1)',
                        position: 'sticky',
                        left: 0,
                        zIndex: 1
                      }}>
                        <span style={{ 
                          color: '#60a5fa',
                          fontFamily: "'JetBrains Mono', monospace",
                          fontSize: '11px',
                          marginRight: '10px',
                          fontWeight: 600
                        }}>
                          {conn.id}
                        </span>
                        <span style={{ color: '#e2e8f0', fontSize: '13px' }}>{conn.nom}</span>
                      </td>
                      {data.blocs.flatMap(bloc => 
                        bloc.competences.map(comp => (
                          <td 
                            key={`${conn.id}-${comp.id}`}
                            style={{ 
                              background: 'rgba(15, 23, 42, 0.4)',
                              padding: '8px',
                              textAlign: 'center',
                              borderBottom: '1px solid rgba(148, 163, 184, 0.1)'
                            }}
                          >
                            {conn.competences.includes(comp.id) && (
                              <span style={{ 
                                display: 'inline-block',
                                width: '20px',
                                height: '20px',
                                borderRadius: '4px',
                                background: 'linear-gradient(135deg, #60a5fa, #3b82f6)',
                                color: '#0f172a',
                                fontWeight: 700,
                                fontSize: '12px',
                                lineHeight: '20px'
                              }}>
                                ‚úï
                              </span>
                            )}
                          </td>
                        ))
                      )}
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          )}
        </div>

        {/* Footer */}
        <div style={{ 
          textAlign: 'center', 
          padding: '24px',
          color: '#64748b',
          fontSize: '12px'
        }}>
          <div style={{ display: 'flex', justifyContent: 'center', gap: '24px', marginBottom: '12px' }}>
            <span><span style={getNiveauStyle(1)}>N1</span> {niveauLabels[1]}</span>
            <span><span style={getNiveauStyle(2)}>N2</span> {niveauLabels[2]}</span>
            <span><span style={getNiveauStyle(3)}>N3</span> {niveauLabels[3]}</span>
            <span><span style={getNiveauStyle(4)}>N4</span> {niveauLabels[4]}</span>
          </div>
        </div>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<FormulaireBTSEBCR />);
    </script>
</body>
</html>
